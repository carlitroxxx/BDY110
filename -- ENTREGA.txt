-- ENTREGA

CREATE TABLE zona (
    id_zona      NUMBER(1) NOT NULL,
    nom_zona     VARCHAR2(10) NOT NULL,
    porc         NUMBER (5,2)NOT NULL
);
ALTER TABLE zona ADD CONSTRAINT pk_zona PRIMARY KEY ( id_zona );

CREATE TABLE marca (
    id_marca      NUMBER(4) NOT NULL,
    nom_marca     VARCHAR2(10) NOT NULL
);
ALTER TABLE marca ADD CONSTRAINT pk_marca PRIMARY KEY ( id_marca );

CREATE TABLE categoria (
    id_categoria      NUMBER(1) NOT NULL,
    nom_categoria     VARCHAR2(20) NOT NULL,
    porcentaje        NUMBER NOT NULL
);
ALTER TABLE categoria ADD CONSTRAINT pk_categoria PRIMARY KEY ( id_categoria );

CREATE TABLE comuna (
    id_comuna      NUMBER(3) generated by default as identity minvalue 100 increment by 5 start with 100 NOT NULL,
    nom_comuna    VARCHAR2(60) NOT NULL
);
ALTER TABLE comuna ADD CONSTRAINT pk_comuna PRIMARY KEY ( id_comuna );


INSERT INTO comuna (nom_comuna)VALUES('Providencia');
INSERT INTO comuna (nom_comuna)VALUES('Santiago');
INSERT INTO comuna (nom_comuna)VALUES('Ñuñoa');
INSERT INTO comuna (nom_comuna)VALUES('La Florida');
INSERT INTO comuna (nom_comuna)VALUES('Maipú');

INSERT INTO zona (id_zona,nom_zona,porc)VALUES(1,'Norte',8.56);
INSERT INTO zona (id_zona,nom_zona,porc)VALUES(2,'Sur',10.48);
INSERT INTO zona (id_zona,nom_zona,porc)VALUES(3,'Oriente',11.27);
INSERT INTO zona (id_zona,nom_zona,porc)VALUES(4,'Poniente',7.24);
INSERT INTO zona (id_zona,nom_zona,porc)VALUES(5,'Centro',7.24);

INSERT INTO categoria (id_categoria,nom_categoria,porcentaje)VALUES(1,'Categoria A',17.5);
INSERT INTO categoria (id_categoria,nom_categoria,porcentaje)VALUES(2,'Categoria B',12.6);
INSERT INTO categoria (id_categoria,nom_categoria,porcentaje)VALUES(3,'Categoria C',9.4);
INSERT INTO categoria (id_categoria,nom_categoria,porcentaje)VALUES(4,'Categoria D',7.2);
INSERT INTO categoria (id_categoria,nom_categoria,porcentaje)VALUES(5,'Categoria E',5.4);

INSERT INTO marca (id_marca,nom_marca)VALUES(1000,'Familand');
INSERT INTO marca (id_marca,nom_marca)VALUES(1100,'Nivea');
INSERT INTO marca (id_marca,nom_marca)VALUES(1200,'Dove');
INSERT INTO marca (id_marca,nom_marca)VALUES(1300,'Gillette');
INSERT INTO marca (id_marca,nom_marca)VALUES(1400,'Monterrey');


CREATE TABLE cliente (
    id_cliente number not null,
    nombre_cliente varchar2(35) not null,
    direccion varchar2(50) not null,
    telefono varchar2(25) not null,
    id_comuna number(3) not null
);
alter table cliente add constraint pk_cliente primary key (id_cliente);
alter table cliente add constraint fk_cliente_comuna foreign key (id_comuna) references comuna(id_comuna);

create table articulo(
    id_articulo number not null,
    nom_articulo varchar2(25) not null,
    precio number not null,
    stock_actual number(4) not null,
    stock_minimo number(4) not null,
    id_marca number(4) not null
);
alter table articulo add constraint pk_articulo primary key (id_articulo);
alter table articulo add constraint fk_articulo_marca foreign key (id_marca) REFERENCES marca(id_marca);

create table vendedor(
    id_vendedor number(6) not null,
    rut_vendedor varchar2(10) unique not null,
    nombres varchar2(25) not null,
    paterno varchar2(15) not null,
    materno varchar2(15),
    fecnac date not null,
    feccontrato date not null,
    sueldo number not null,
    comision number not null,
    id_zona number(1),
    id_categoria number(1) not null
);
alter table vendedor add constraint pk_vendedor primary key (id_vendedor);
alter table vendedor add constraint fk_vendedor_zona foreign key (id_zona) REFERENCES zona(id_zona);
alter table vendedor add constraint fk_vendedor_categoria foreign key (id_categoria) REFERENCES categoria(id_categoria);


create table factura(
    id_factura number not null,
    id_cliente number not null,
    id_vendedor number not null,
    fecha_factura date not null
);
alter table factura add constraint pk_factura primary key (id_factura);
alter table factura add constraint fk_factura_cliente foreign key (id_cliente) REFERENCES cliente(id_cliente);
alter table factura add constraint fk_factura_vendedor foreign key (id_vendedor) REFERENCES vendedor(id_vendedor);


create sequence seq_factura 
increment by 10
start with 10000;


create table detallefactura(
    id_factura number not null,
    id_articulo number not null,
    cantidad varchar2(6) not null
);
alter table detallefactura add constraint pk_detallefactura primary key (id_factura,id_articulo);
alter table detallefactura add constraint fk_detallefactura_factura foreign key (id_factura) REFERENCES factura(id_factura);
alter table detallefactura add constraint fk_detallefactura_articulo foreign key (id_articulo) REFERENCES articulo(id_articulo);


insert into cliente(id_cliente,nombre_cliente,direccion, telefono, id_comuna) values (1,'ALCARAZ NOVOA MONTSERRAT','BUENAVENTURA 160',564522114,100);
insert into cliente(ID_CLIENTE, NOMBRE_CLIENTE, DIRECCION, TELEFONO, ID_COMUNA) values (2, 'JIMENEZ LORCA ELENA', 'LAGUNAS 52 DPTO. K', '566665443', 105);
insert into cliente(ID_CLIENTE, NOMBRE_CLIENTE, DIRECCION, TELEFONO, ID_COMUNA) values (3, 'TORRES ROCA MARÍA', 'DONATELLO 7421', '565626134', 115);
insert into cliente(ID_CLIENTE, NOMBRE_CLIENTE, DIRECCION, TELEFONO, ID_COMUNA) values (4, 'LOPEZ ROJAS THOMAS', 'ORDOÑEZ 2007', '562989233', 120);
insert into cliente(ID_CLIENTE, NOMBRE_CLIENTE, DIRECCION, TELEFONO, ID_COMUNA) values (5, 'ZAMORA MOLINA TOMÁS', 'HUERFANOS 1294', '564343456', 105);


insert into articulo (id_articulo, nom_articulo, precio, stock_actual, stock_minimo, id_marca) values (1, 'JABON', 1250, 150, 80, 1000);
insert into articulo (id_articulo, nom_articulo, precio, stock_actual, stock_minimo, id_marca) values (2, 'SHAMPOO', 2325, 50, 20, 1200);
insert into articulo (id_articulo, nom_articulo, precio, stock_actual, stock_minimo, id_marca) values (3, 'ACONDICIONADOR', 2100, 200, 50, 1200);
insert into articulo (id_articulo, nom_articulo, precio, stock_actual, stock_minimo, id_marca) values (4, 'CREMA DE AFEITAR', 3475, 50, 20, 1300);
insert into articulo (id_articulo, nom_articulo, precio, stock_actual, stock_minimo, id_marca) values (5, 'CAFE', 3500, 80, 40, 1400);

INSERT INTO VENDEDOR (ID_VENDEDOR, RUT_VENDEDOR, NOMBRES, PATERNO, MATERNO, FECNAC, FECCONTRATO, SUELDO, COMISION, ID_ZONA, ID_CATEGORIA)
VALUES(2, '22222222-3', 'MARTA', 'VIVEROS', NULL, '07-08-1978', '02-07-2000', 345000, 0.07, 2, 2);
INSERT INTO VENDEDOR (ID_VENDEDOR, RUT_VENDEDOR, NOMBRES, PATERNO, MATERNO, FECNAC, FECCONTRATO, SUELDO, COMISION, ID_ZONA, ID_CATEGORIA)
VALUES(3, '33333333-K', 'OSCAR', 'CACERES', 'LAGOS', '09-10-1979', '03-09-2001', 367400, 0.13, 1, 1);
INSERT INTO VENDEDOR (ID_VENDEDOR, RUT_VENDEDOR, NOMBRES, PATERNO, MATERNO, FECNAC, FECCONTRATO, SUELDO, COMISION, ID_ZONA, ID_CATEGORIA)
VALUES(4, '44444444-5', 'MILENA', 'MENA', 'CARTES', '08-12-1977', '03-11-1999', 373620, 0.05, 3, 3);
INSERT INTO VENDEDOR (ID_VENDEDOR, RUT_VENDEDOR, NOMBRES, PATERNO, MATERNO, FECNAC, FECCONTRATO, SUELDO, COMISION, ID_ZONA, ID_CATEGORIA)
VALUES(5, '55555555-6', 'ESTEBAN', 'ROMERO', NULL, '08-12-1988', '03-11-2015', 373620, 0.08, 2, 3);

INSERT INTO FACTURA VALUES(SEQ_FACTURA.NEXTVAL,1,2,'18-01-2022');
INSERT INTO FACTURA VALUES(SEQ_FACTURA.NEXTVAL,2,4,'18-01-2022');
INSERT INTO FACTURA VALUES(SEQ_FACTURA.NEXTVAL,4,3,'18-01-2022');
INSERT INTO FACTURA VALUES(SEQ_FACTURA.NEXTVAL,3,5,'18-01-2022');
INSERT INTO FACTURA VALUES(SEQ_FACTURA.NEXTVAL,2,2,'18-01-2022');

INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES
(10000, 1, 20);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10000, 5, 23);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10010, 3, 38);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10010, 4, 43);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10010, 1, 48);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10020, 4, 30);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10020, 5, 20);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10030, 2, 60);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10030, 3, 45);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10030, 4, 35);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10040, 4, 29);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10040, 5, 28);
INSERT INTO DETALLEFACTURA (ID_FACTURA, ID_ARTICULO, CANTIDAD)
VALUES(10040, 2, 21);


commit;